<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>miceFast - Introduction â€¢ miceFast</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="miceFast - Introduction">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">miceFast</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.8.2.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/miceFast-intro.html">miceFast - Introduction</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/Polkas/miceFast/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>miceFast - Introduction</h1>
                        <h4 data-toc-skip class="author">Maciej
Nasinski</h4>
            
            <h4 data-toc-skip class="date">2025-02-03</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/Polkas/miceFast/blob/main/vignettes/miceFast-intro.Rmd" class="external-link"><code>vignettes/miceFast-intro.Rmd</code></a></small>
      <div class="hidden name"><code>miceFast-intro.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>This vignette introduces the <strong>miceFast</strong> package, which
provides fast imputations in an object-oriented programming style.<br>
The underlying methods rely on quantitative models with closed-form
solutions implemented via linear algebra operations.</p>
<p>Additional utility functions are provided for easy integration with
popular R packages such as <strong>dplyr</strong> and
<strong>data.table</strong>.</p>
<div class="section level3">
<h3 id="installation-and-setup">Installation and Setup<a class="anchor" aria-label="anchor" href="#installation-and-setup"></a>
</h3>
<p>Before you begin, ensure the <strong>miceFast</strong> package is
installed. You may also want to install a high-performance BLAS library
for significant speedups.</p>
<div class="section level4">
<h4 id="blas">BLAS<a class="anchor" aria-label="anchor" href="#blas"></a>
</h4>
<p><strong>Recommended: Install an optimized BLAS library (potentially
up to 100x faster):</strong></p>
<ul>
<li><p><strong>Linux</strong>:
<code>sudo apt-get install libopenblas-dev</code></p></li>
<li>
<p><strong>macOS (Accelerate/vecLib BLAS)</strong>:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="bu">cd</span> /Library/Frameworks/R.framework/Resources/lib</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">ln</span> <span class="at">-sf</span> /System/Library/Frameworks/Accelerate.framework/Frameworks/vecLib.framework/Versions/Current/libBLAS.dylib libRblas.dylib</span></code></pre></div>
</li>
</ul>
</div>
</div>
<div class="section level3">
<h3 id="loading-the-package-and-setting-a-seed">Loading the Package and Setting a Seed<a class="anchor" aria-label="anchor" href="#loading-the-package-and-setting-a-seed"></a>
</h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pkgs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"miceFast"</span>, <span class="st">"mice"</span>, <span class="st">"ggplot2"</span>, <span class="st">"dplyr"</span>, <span class="st">"data.table"</span><span class="op">)</span></span>
<span><span class="va">inst</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">pkgs</span>, <span class="va">library</span>, character.only <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123456</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="description">Description<a class="anchor" aria-label="anchor" href="#description"></a>
</h3>
<p>The <strong>miceFast</strong> package accelerates imputations for
quantitative models (with closed-form solutions) by using efficient
linear algebra routines. It offers substantial speed improvements
in:</p>
<ul>
<li>
<strong>Linear Discriminant Analysis</strong> (up to 5x
faster),</li>
<li>
<strong>Grouping-based calculations</strong> (often 10x or more,
depending on data size, number of groups, etc.),</li>
<li>
<strong>Multiple imputations</strong> (faster by approximately the
number of imputations, since the core model is computed only once),</li>
<li>
<strong>Variance Inflation Factor (VIF)</strong> computations
(around 5x faster by skipping redundant steps),</li>
<li>
<strong>Predictive Mean Matching (PMM)</strong> (around 3x faster
thanks to pre-sorting and binary search).</li>
</ul>
<blockquote>
<p><strong>Note:</strong> For details on the performance-testing
procedure, see the file <code>performance_validity.R</code> in the
<code>extdata</code> folder. Additional simulation plots (which you are
free to modify) are located in <code>extdata/images</code>.<br><em>Environment: R 4.2 on Mac M1.</em></p>
</blockquote>
</div>
<div class="section level3">
<h3 id="motivations">Motivations<a class="anchor" aria-label="anchor" href="#motivations"></a>
</h3>
<p>Missing data is a common issue in data analysis. One approach is to
delete any row containing missing observations, though this can degrade
the quality or representativeness of your dataset. Another, often
better, approach is to use imputation methods (such as multiple or
regular imputations) to fill in missing data, leveraging observed
independent variables.</p>
<p>Since R and Python are user-friendly but can be slower for heavy
computation, <strong>miceFast</strong> uses efficient C++/RcppArmadillo
routines under the hood to speed up the imputation process.</p>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="introduction-for-dplyrdata-table-users">Introduction for dplyr/data.table Users<a class="anchor" aria-label="anchor" href="#introduction-for-dplyrdata-table-users"></a>
</h2>
<p>The <strong>miceFast</strong> package provides additional functions
(<code>fill_NA</code> and <code>fill_NA_N</code>) that are designed to
be stable in the presence of user-level mistakes or complex data
structures. Below are minimal examples using <strong>dplyr</strong> and
<strong>data.table</strong>.</p>
<div class="section level3">
<h3 id="example-data">Example Data<a class="anchor" aria-label="anchor" href="#example-data"></a>
</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">air_miss</span><span class="op">)</span>  <span class="co"># airquality with additional variables</span></span></code></pre></div>
<div class="section level4">
<h4 id="examining-missingness">Examining Missingness<a class="anchor" aria-label="anchor" href="#examining-missingness"></a>
</h4>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/upset_NA.html">upset_NA</a></span><span class="op">(</span><span class="va">air_miss</span>, <span class="fl">6</span><span class="op">)</span></span></code></pre></div>
<p><img src="miceFast-intro_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
</div>
</div>
<div class="section level3">
<h3 id="using-dplyr">Using dplyr<a class="anchor" aria-label="anchor" href="#using-dplyr"></a>
</h3>
<p>Below we show how to:</p>
<ol style="list-style-type: decimal">
<li>Calculate VIF.</li>
<li>Perform various imputations with and without grouping.</li>
<li>Safely handle collinearity or small group sizes by wrapping calls in
<code>tryCatch</code>.</li>
</ol>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># VIF (Variance Inflation Factor) &gt; ~10 suggests collinearity problems.</span></span>
<span><span class="fu"><a href="../reference/VIF.html">VIF</a></span><span class="op">(</span></span>
<span>  <span class="va">air_miss</span>,</span>
<span>  posit_y <span class="op">=</span> <span class="st">"Ozone"</span>,</span>
<span>  posit_x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Solar.R"</span>, <span class="st">"Wind"</span>, <span class="st">"Temp"</span>, <span class="st">"x_character"</span>,</span>
<span>              <span class="st">"Day"</span>, <span class="st">"weights"</span>, <span class="st">"groups"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##           [,1]</span></span>
<span><span class="co">## [1,] 24.978996</span></span>
<span><span class="co">## [2,]  1.445308</span></span>
<span><span class="co">## [3,]  3.077776</span></span>
<span><span class="co">## [4,] 42.248792</span></span>
<span><span class="co">## [5,]  1.083795</span></span>
<span><span class="co">## [6,]  1.100853</span></span>
<span><span class="co">## [7,]  2.954588</span></span></code></pre>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">air_miss</span> <span class="op">&lt;-</span> <span class="va">air_miss</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># Impute with grouping and weights</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">groups</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/do.html" class="external-link">do</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="va">.</span>, </span>
<span>    Solar_R_imp <span class="op">=</span> <span class="fu"><a href="../reference/fill_NA.html">fill_NA</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="va">.</span>,</span>
<span>      model <span class="op">=</span> <span class="st">"lm_pred"</span>,</span>
<span>      posit_y <span class="op">=</span> <span class="st">"Solar.R"</span>,</span>
<span>      posit_x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Wind"</span>, <span class="st">"Temp"</span>, <span class="st">"Intercept"</span><span class="op">)</span>,</span>
<span>      w <span class="op">=</span> <span class="va">.</span><span class="op">[[</span><span class="st">"weights"</span><span class="op">]</span><span class="op">]</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># Impute a discrete variable</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>x_character_imp <span class="op">=</span> <span class="fu"><a href="../reference/fill_NA.html">fill_NA</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">.</span>,</span>
<span>    model <span class="op">=</span> <span class="st">"lda"</span>,</span>
<span>    posit_y <span class="op">=</span> <span class="st">"x_character"</span>,</span>
<span>    posit_x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Wind"</span>, <span class="st">"Temp"</span><span class="op">)</span></span>
<span>  <span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># Log regression because Ozone is roughly log-normal</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Ozone_imp1 <span class="op">=</span> <span class="fu"><a href="../reference/fill_NA.html">fill_NA</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">.</span>,</span>
<span>    model <span class="op">=</span> <span class="st">"lm_bayes"</span>,</span>
<span>    posit_y <span class="op">=</span> <span class="st">"Ozone"</span>,</span>
<span>    posit_x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Intercept"</span><span class="op">)</span>,</span>
<span>    logreg <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># Impute by position indices</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Ozone_imp2 <span class="op">=</span> <span class="fu"><a href="../reference/fill_NA.html">fill_NA</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">.</span>,</span>
<span>    model <span class="op">=</span> <span class="st">"lm_bayes"</span>,</span>
<span>    posit_y <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    posit_x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">6</span><span class="op">)</span>,</span>
<span>    logreg <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># Imputations (mean of 30 draws)</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Ozone_imp3 <span class="op">=</span> <span class="fu"><a href="../reference/fill_NA_N.html">fill_NA_N</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">.</span>,</span>
<span>    model <span class="op">=</span> <span class="st">"lm_noise"</span>,</span>
<span>    posit_y <span class="op">=</span> <span class="st">"Ozone"</span>,</span>
<span>    posit_x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Intercept"</span>, <span class="st">"x_character_imp"</span>, <span class="st">"Wind"</span>, <span class="st">"Temp"</span><span class="op">)</span>,</span>
<span>    w <span class="op">=</span> <span class="va">.</span><span class="op">[[</span><span class="st">"weights"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>    logreg <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    k <span class="op">=</span> <span class="fl">30</span></span>
<span>  <span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Ozone_imp4 <span class="op">=</span> <span class="fu"><a href="../reference/fill_NA_N.html">fill_NA_N</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">.</span>,</span>
<span>    model <span class="op">=</span> <span class="st">"lm_bayes"</span>,</span>
<span>    posit_y <span class="op">=</span> <span class="st">"Ozone"</span>,</span>
<span>    posit_x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Intercept"</span>, <span class="st">"x_character_imp"</span>, <span class="st">"Wind"</span>, <span class="st">"Temp"</span><span class="op">)</span>,</span>
<span>    w <span class="op">=</span> <span class="va">.</span><span class="op">[[</span><span class="st">"weights"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>    logreg <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    k <span class="op">=</span> <span class="fl">30</span></span>
<span>  <span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">groups</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># Single evaluation model</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/do.html" class="external-link">do</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="va">.</span>,</span>
<span>    Ozone_imp5 <span class="op">=</span> <span class="fu"><a href="../reference/fill_NA.html">fill_NA</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="va">.</span>,</span>
<span>      model <span class="op">=</span> <span class="st">"lm_pred"</span>,</span>
<span>      posit_y <span class="op">=</span> <span class="st">"Ozone"</span>,</span>
<span>      posit_x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Intercept"</span>, <span class="st">"x_character_imp"</span>, <span class="st">"Wind"</span>, <span class="st">"Temp"</span><span class="op">)</span>,</span>
<span>      w <span class="op">=</span> <span class="va">.</span><span class="op">[[</span><span class="st">"weights"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>      logreg <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/do.html" class="external-link">do</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="va">.</span>,</span>
<span>    Ozone_imp6 <span class="op">=</span> <span class="fu"><a href="../reference/fill_NA_N.html">fill_NA_N</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="va">.</span>,</span>
<span>      model <span class="op">=</span> <span class="st">"pmm"</span>,</span>
<span>      posit_y <span class="op">=</span> <span class="st">"Ozone"</span>,</span>
<span>      posit_x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Intercept"</span>, <span class="st">"x_character_imp"</span>, <span class="st">"Wind"</span>, <span class="st">"Temp"</span><span class="op">)</span>,</span>
<span>      w <span class="op">=</span> <span class="va">.</span><span class="op">[[</span><span class="st">"weights"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>      logreg <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>      k <span class="op">=</span> <span class="fl">20</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># Combine imputations</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Ozone_imp_mix <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowMeans</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">.</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"Ozone_imp"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># Protect against errors in small groups</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">groups</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/do.html" class="external-link">do</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="va">.</span>,</span>
<span>    Ozone_chac_imp <span class="op">=</span> <span class="kw"><a href="https://rdrr.io/r/base/conditions.html" class="external-link">tryCatch</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="../reference/fill_NA.html">fill_NA</a></span><span class="op">(</span></span>
<span>        x <span class="op">=</span> <span class="va">.</span>,</span>
<span>        model <span class="op">=</span> <span class="st">"lda"</span>,</span>
<span>        posit_y <span class="op">=</span> <span class="st">"Ozone_chac"</span>,</span>
<span>        posit_x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Intercept"</span>, <span class="st">"Month"</span>, <span class="st">"Day"</span>, <span class="st">"Temp"</span>, <span class="st">"x_character_imp"</span><span class="op">)</span>,</span>
<span>        w <span class="op">=</span> <span class="va">.</span><span class="op">[[</span><span class="st">"weights"</span><span class="op">]</span><span class="op">]</span></span>
<span>      <span class="op">)</span>,</span>
<span>      error <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">e</span><span class="op">)</span> <span class="va">.</span><span class="op">[[</span><span class="st">"Ozone_chac"</span><span class="op">]</span><span class="op">]</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="section level4">
<h4 id="visualizing-results">Visualizing Results<a class="anchor" aria-label="anchor" href="#visualizing-results"></a>
</h4>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Compare original vs. imputed distributions</span></span>
<span><span class="fu"><a href="../reference/compare_imp.html">compare_imp</a></span><span class="op">(</span><span class="va">air_miss</span>, origin <span class="op">=</span> <span class="st">"Ozone"</span>, target <span class="op">=</span> <span class="st">"Ozone_imp_mix"</span><span class="op">)</span></span></code></pre></div>
<p><img src="miceFast-intro_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Or compare multiple imputation columns</span></span>
<span><span class="fu"><a href="../reference/compare_imp.html">compare_imp</a></span><span class="op">(</span><span class="va">air_miss</span>, origin <span class="op">=</span> <span class="st">"Ozone"</span>, target <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Ozone_imp2"</span>, <span class="st">"Ozone_imp_mix"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="miceFast-intro_files/figure-html/unnamed-chunk-6-2.png" width="700"></p>
</div>
</div>
<div class="section level3">
<h3 id="using-data-table">Using data.table<a class="anchor" aria-label="anchor" href="#using-data-table"></a>
</h3>
<p>Below is a similar approach using <strong>data.table</strong>
syntax.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">air_miss</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/data.table/man/setDT.html" class="external-link">setDT</a></span><span class="op">(</span><span class="va">air_miss</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Imputations</span></span>
<span><span class="va">air_miss</span><span class="op">[</span>, <span class="va">Solar_R_imp</span> <span class="op">:=</span> <span class="fu"><a href="../reference/fill_NA_N.html">fill_NA_N</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">.SD</span>,</span>
<span>  model <span class="op">=</span> <span class="st">"lm_bayes"</span>,</span>
<span>  posit_y <span class="op">=</span> <span class="st">"Solar.R"</span>,</span>
<span>  posit_x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Wind"</span>,<span class="st">"Temp"</span>,<span class="st">"Intercept"</span><span class="op">)</span>,</span>
<span>  w <span class="op">=</span> <span class="va">.SD</span><span class="op">[[</span><span class="st">"weights"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>  k <span class="op">=</span> <span class="fl">100</span></span>
<span><span class="op">)</span>, by <span class="op">=</span> <span class="fu">.</span><span class="op">(</span><span class="va">groups</span><span class="op">)</span><span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="va">.</span><span class="op">[</span>, <span class="va">x_character_imp</span> <span class="op">:=</span> <span class="fu"><a href="../reference/fill_NA.html">fill_NA</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">.SD</span>,</span>
<span>    model <span class="op">=</span> <span class="st">"lda"</span>,</span>
<span>    posit_y <span class="op">=</span> <span class="st">"x_character"</span>,</span>
<span>    posit_x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Wind"</span>,<span class="st">"Temp"</span>,<span class="st">"groups"</span><span class="op">)</span></span>
<span>  <span class="op">)</span><span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="va">.</span><span class="op">[</span>, <span class="va">Ozone_imp1</span> <span class="op">:=</span> <span class="fu"><a href="../reference/fill_NA.html">fill_NA</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">.SD</span>,</span>
<span>    model <span class="op">=</span> <span class="st">"lm_bayes"</span>,</span>
<span>    posit_y <span class="op">=</span> <span class="st">"Ozone"</span>,</span>
<span>    posit_x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Intercept"</span><span class="op">)</span>,</span>
<span>    logreg <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span><span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="va">.</span><span class="op">[</span>, <span class="va">Ozone_imp2</span> <span class="op">:=</span> <span class="fu"><a href="../reference/fill_NA.html">fill_NA</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">.SD</span>,</span>
<span>    model <span class="op">=</span> <span class="st">"lm_bayes"</span>,</span>
<span>    posit_y <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    posit_x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">6</span><span class="op">)</span>,</span>
<span>    logreg <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span><span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="va">.</span><span class="op">[</span>, <span class="va">Ozone_imp3</span> <span class="op">:=</span> <span class="fu"><a href="../reference/fill_NA_N.html">fill_NA_N</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">.SD</span>,</span>
<span>    model <span class="op">=</span> <span class="st">"lm_noise"</span>,</span>
<span>    posit_y <span class="op">=</span> <span class="st">"Ozone"</span>,</span>
<span>    posit_x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Intercept"</span>,<span class="st">"x_character_imp"</span>,<span class="st">"Wind"</span>,<span class="st">"Temp"</span><span class="op">)</span>,</span>
<span>    w <span class="op">=</span> <span class="va">.SD</span><span class="op">[[</span><span class="st">"weights"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>    logreg <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    k <span class="op">=</span> <span class="fl">30</span></span>
<span>  <span class="op">)</span><span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="va">.</span><span class="op">[</span>, <span class="va">Ozone_imp4</span> <span class="op">:=</span> <span class="fu"><a href="../reference/fill_NA_N.html">fill_NA_N</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">.SD</span>,</span>
<span>    model <span class="op">=</span> <span class="st">"lm_bayes"</span>,</span>
<span>    posit_y <span class="op">=</span> <span class="st">"Ozone"</span>,</span>
<span>    posit_x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Intercept"</span>,<span class="st">"x_character_imp"</span>,<span class="st">"Wind"</span>,<span class="st">"Temp"</span><span class="op">)</span>,</span>
<span>    w <span class="op">=</span> <span class="va">.SD</span><span class="op">[[</span><span class="st">"weights"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>    logreg <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    k <span class="op">=</span> <span class="fl">30</span></span>
<span>  <span class="op">)</span><span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="va">.</span><span class="op">[</span>, <span class="va">Ozone_imp5</span> <span class="op">:=</span> <span class="fu"><a href="../reference/fill_NA.html">fill_NA</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">.SD</span>,</span>
<span>    model <span class="op">=</span> <span class="st">"lm_pred"</span>,</span>
<span>    posit_y <span class="op">=</span> <span class="st">"Ozone"</span>,</span>
<span>    posit_x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Intercept"</span>,<span class="st">"x_character_imp"</span>,<span class="st">"Wind"</span>,<span class="st">"Temp"</span><span class="op">)</span>,</span>
<span>    w <span class="op">=</span> <span class="va">.SD</span><span class="op">[[</span><span class="st">"weights"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>    logreg <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span>, by <span class="op">=</span> <span class="fu">.</span><span class="op">(</span><span class="va">groups</span><span class="op">)</span><span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="va">.</span><span class="op">[</span>, <span class="va">Ozone_imp6</span> <span class="op">:=</span> <span class="fu"><a href="../reference/fill_NA_N.html">fill_NA_N</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">.SD</span>,</span>
<span>    model <span class="op">=</span> <span class="st">"pmm"</span>,</span>
<span>    posit_y <span class="op">=</span> <span class="st">"Ozone"</span>,</span>
<span>    posit_x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Intercept"</span>,<span class="st">"x_character_imp"</span>,<span class="st">"Wind"</span>,<span class="st">"Temp"</span><span class="op">)</span>,</span>
<span>    w <span class="op">=</span> <span class="va">.SD</span><span class="op">[[</span><span class="st">"weights"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>    logreg <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    k <span class="op">=</span> <span class="fl">10</span></span>
<span>  <span class="op">)</span>, by <span class="op">=</span> <span class="fu">.</span><span class="op">(</span><span class="va">groups</span><span class="op">)</span><span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># Average across a set of methods</span></span>
<span>  <span class="va">.</span><span class="op">[</span>, <span class="va">Ozone_imp_mix</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">.SD</span>, <span class="fl">1</span>, <span class="va">mean</span><span class="op">)</span>, .SDcols <span class="op">=</span> <span class="va">Ozone_imp1</span><span class="op">:</span><span class="va">Ozone_imp6</span><span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># tryCatch for small group issues or collinearity</span></span>
<span>  <span class="va">.</span><span class="op">[</span>, <span class="va">Ozone_chac_imp</span> <span class="op">:=</span> <span class="kw"><a href="https://rdrr.io/r/base/conditions.html" class="external-link">tryCatch</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="../reference/fill_NA.html">fill_NA</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="va">.SD</span>,</span>
<span>      model <span class="op">=</span> <span class="st">"lda"</span>,</span>
<span>      posit_y <span class="op">=</span> <span class="st">"Ozone_chac"</span>,</span>
<span>      posit_x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Intercept"</span>,<span class="st">"Month"</span>,<span class="st">"Day"</span>,<span class="st">"Temp"</span>,<span class="st">"x_character_imp"</span><span class="op">)</span>,</span>
<span>      w <span class="op">=</span> <span class="va">.SD</span><span class="op">[[</span><span class="st">"weights"</span><span class="op">]</span><span class="op">]</span></span>
<span>    <span class="op">)</span>,</span>
<span>    error <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">e</span><span class="op">)</span> <span class="va">.SD</span><span class="op">[[</span><span class="st">"Ozone_chac"</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="op">)</span>, by <span class="op">=</span> <span class="fu">.</span><span class="op">(</span><span class="va">groups</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="generating-data-with-the-corrdata-module">Generating Data with the corrData Module<a class="anchor" aria-label="anchor" href="#generating-data-with-the-corrdata-module"></a>
</h2>
<p>You can generate correlated data via <code>corrData</code>:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Constructors:</span></span>
<span><span class="fu">new</span><span class="op">(</span><span class="va">corrData</span>, <span class="va">nr_cat</span>, <span class="va">n_obs</span>, <span class="va">means</span>, <span class="va">cor_matrix</span><span class="op">)</span></span>
<span><span class="fu">new</span><span class="op">(</span><span class="va">corrData</span>, <span class="va">n_obs</span>, <span class="va">means</span>, <span class="va">cor_matrix</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Some relevant methods:</span></span>
<span><span class="va">cd_obj</span><span class="op">$</span><span class="fu">fill</span><span class="op">(</span><span class="st">"type"</span><span class="op">)</span>  <span class="co"># "contin", "binom", or "discrete"</span></span></code></pre></div>
<ul>
<li>
<code>nr_cat</code>: number of categories for a discrete dependent
variable<br>
</li>
<li>
<code>n_obs</code>: number of observations<br>
</li>
<li>
<code>means</code>: centers for independent variables<br>
</li>
<li>
<code>cor_matrix</code>: a positive-definite correlation matrix</li>
</ul>
<p>Example usage:</p>
<hr>
</div>
<div class="section level2">
<h2 id="imputing-data-with-the-micefast-module">Imputing Data with the miceFast Module<a class="anchor" aria-label="anchor" href="#imputing-data-with-the-micefast-module"></a>
</h2>
<p>The <strong>miceFast</strong> module performs fast imputations via
various built-in models. Below is a summary of its main methods:</p>
<ol style="list-style-type: decimal">
<li>
<strong><code>set_data(x)</code></strong>: Provide the data as a
numeric matrix by reference.<br>
</li>
<li>
<strong><code>set_g(g)</code></strong>: Provide a grouping variable
(numeric vector, must be positive, no NAs).<br>
</li>
<li>
<strong><code>set_w(w)</code></strong>: Provide a weighting variable
(numeric vector, must be positive, no NAs).<br>
</li>
<li>
<strong><code>impute(model, posit_y, posit_x)</code></strong>:
Single imputation according to the chosen model.<br>
</li>
<li>
<strong><code>impute_N(model, posit_y, posit_x, k)</code></strong>:
Multiple imputations (averaged result) for certain models.<br>
</li>
<li>
<strong><code>update_var(posit_y, imputations)</code></strong>:
Permanently update the objectâ€™s data for the specified column with new
imputations.<br>
</li>
<li>
<strong><code>vifs(posit_y, posit_x)</code></strong>: Compute
Variance Inflation Factors.<br>
</li>
<li>
<strong><code>sort_byg()</code></strong> /
<strong><code>is_sorted_byg()</code></strong>: Sort the data by the
grouping variable (or check if sorted).<br>
</li>
<li>
<strong><code>which_updated()</code></strong>: Check which variables
have been permanently updated in the object.</li>
</ol>
<p>Supported models:</p>
<ul>
<li>
<code>"lda"</code>: Linear discriminant analysis (for categorical
<code>posit_y</code>).<br>
</li>
<li>
<code>"lm_pred"</code>: Standard linear model prediction (including
a mean-imputation approach if you only include an intercept).<br>
</li>
<li>
<code>"lm_bayes"</code>: Linear model with Bayesian noise.<br>
</li>
<li>
<code>"lm_noise"</code>: Similar to <code>"lm_bayes"</code> but with
different noise assumptions.<br>
</li>
<li>
<code>"pmm"</code>: Predictive Mean Matching (used via
<code>impute_N</code>).</li>
</ul>
<blockquote>
<p><em>Note:</em> For purely mean imputation, add an intercept column
and use <code>"lm_pred"</code>. The LDA model requires at least 15
complete observations. Linear models require at least as many complete
observations as the number of predictors.</p>
</blockquote>
<div class="section level3">
<h3 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h3>
<div class="section level4">
<h4 id="simple-usage">Simple Usage<a class="anchor" aria-label="anchor" href="#simple-usage"></a>
</h4>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://amices.org/mice/reference/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="fu">mice</span><span class="fu">::</span><span class="va"><a href="https://amices.org/mice/reference/nhanes.html" class="external-link">nhanes</a></span><span class="op">)</span>, intercept <span class="op">=</span> <span class="fl">1</span>, index <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="fu">mice</span><span class="fu">::</span><span class="va"><a href="https://amices.org/mice/reference/nhanes.html" class="external-link">nhanes</a></span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu">new</span><span class="op">(</span><span class="va">miceFast</span><span class="op">)</span></span>
<span><span class="va">model</span><span class="op">$</span><span class="fu">set_data</span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Single imputation, linear model</span></span>
<span><span class="va">imp_result</span> <span class="op">&lt;-</span> <span class="va">model</span><span class="op">$</span><span class="fu">impute</span><span class="op">(</span><span class="st">"lm_pred"</span>, posit_y <span class="op">=</span> <span class="fl">2</span>, posit_x <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">model</span><span class="op">$</span><span class="fu">update_var</span><span class="op">(</span><span class="fl">2</span>, <span class="va">imp_result</span><span class="op">$</span><span class="va">imputations</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># LDA imputation for a categorical variable</span></span>
<span><span class="va">model</span><span class="op">$</span><span class="fu">update_var</span><span class="op">(</span><span class="fl">3</span>, <span class="va">model</span><span class="op">$</span><span class="fu">impute</span><span class="op">(</span><span class="st">"lda"</span>, <span class="fl">3</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">imputations</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Multiple imputation example</span></span>
<span><span class="va">multi_imp</span> <span class="op">&lt;-</span> <span class="va">model</span><span class="op">$</span><span class="fu">impute_N</span><span class="op">(</span><span class="st">"lm_bayes"</span>, <span class="fl">4</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span>, k <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">model</span><span class="op">$</span><span class="fu">update_var</span><span class="op">(</span><span class="fl">4</span>, <span class="va">multi_imp</span><span class="op">$</span><span class="va">imputations</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Check which variables were updated</span></span>
<span><span class="va">model</span><span class="op">$</span><span class="fu">which_updated</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 2 3 4</span></span></code></pre>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Always be cautious with 'update_var' </span></span>
<span><span class="co"># since it permanently alters the object and your data matrix.</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="example-with-weights-and-groups-pre-sorted">Example with Weights and Groups (Pre-sorted)<a class="anchor" aria-label="anchor" href="#example-with-weights-and-groups-pre-sorted"></a>
</h4>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://amices.org/mice/reference/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">airquality</span><span class="op">[</span>,<span class="op">-</span><span class="fl">5</span><span class="op">]</span><span class="op">)</span>, intercept <span class="op">=</span> <span class="fl">1</span>, index <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">airquality</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">weights</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">rgamma</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>, <span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">groups</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">airquality</span><span class="op">[</span>,<span class="fl">5</span><span class="op">]</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu">new</span><span class="op">(</span><span class="va">miceFast</span><span class="op">)</span></span>
<span><span class="va">model</span><span class="op">$</span><span class="fu">set_data</span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="va">model</span><span class="op">$</span><span class="fu">set_w</span><span class="op">(</span><span class="va">weights</span><span class="op">)</span></span>
<span><span class="va">model</span><span class="op">$</span><span class="fu">set_g</span><span class="op">(</span><span class="va">groups</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Impute with group-wise weighting</span></span>
<span><span class="va">model</span><span class="op">$</span><span class="fu">update_var</span><span class="op">(</span><span class="fl">1</span>, <span class="va">model</span><span class="op">$</span><span class="fu">impute</span><span class="op">(</span><span class="st">"lm_pred"</span>, <span class="fl">1</span>, <span class="fl">6</span><span class="op">)</span><span class="op">$</span><span class="va">imputations</span><span class="op">)</span></span>
<span><span class="va">model</span><span class="op">$</span><span class="fu">update_var</span><span class="op">(</span><span class="fl">2</span>, <span class="va">model</span><span class="op">$</span><span class="fu">impute_N</span><span class="op">(</span><span class="st">"lm_bayes"</span>, <span class="fl">2</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">5</span>,<span class="fl">6</span><span class="op">)</span>, k <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">$</span><span class="va">imputations</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Inspect updated data, returning to original order via model$get_index()</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://amices.org/mice/reference/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">model</span><span class="op">$</span><span class="fu">get_data</span><span class="op">(</span><span class="op">)</span>, <span class="va">model</span><span class="op">$</span><span class="fu">get_g</span><span class="op">(</span><span class="op">)</span>, <span class="va">model</span><span class="op">$</span><span class="fu">get_w</span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">model</span><span class="op">$</span><span class="fu">get_index</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>, <span class="op">]</span>, <span class="fl">4</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8]      [,9]</span></span>
<span><span class="co">## [1,]   41  190  7.4   67    1    1    1    5 1.2183624</span></span>
<span><span class="co">## [2,]   36  118  8.0   72    2    1    2    5 1.2866076</span></span>
<span><span class="co">## [3,]   12  149 12.6   74    3    1    3    5 0.7953631</span></span>
<span><span class="co">## [4,]   18  313 11.5   62    4    1    4    5 0.7386522</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="example-with-unsorted-groups">Example with Unsorted Groups<a class="anchor" aria-label="anchor" href="#example-with-unsorted-groups"></a>
</h4>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://amices.org/mice/reference/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">airquality</span><span class="op">[</span>, <span class="op">-</span><span class="fl">5</span><span class="op">]</span><span class="op">)</span>, intercept <span class="op">=</span> <span class="fl">1</span>, index <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">airquality</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">weights</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">rgamma</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>, <span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">groups</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">8</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu">new</span><span class="op">(</span><span class="va">miceFast</span><span class="op">)</span></span>
<span><span class="va">model</span><span class="op">$</span><span class="fu">set_data</span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="va">model</span><span class="op">$</span><span class="fu">set_w</span><span class="op">(</span><span class="va">weights</span><span class="op">)</span></span>
<span><span class="va">model</span><span class="op">$</span><span class="fu">set_g</span><span class="op">(</span><span class="va">groups</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># The data will be automatically sorted by 'groups' during the first imputation:</span></span>
<span><span class="va">model</span><span class="op">$</span><span class="fu">update_var</span><span class="op">(</span><span class="fl">1</span>, <span class="va">model</span><span class="op">$</span><span class="fu">impute</span><span class="op">(</span><span class="st">"lm_pred"</span>, <span class="fl">1</span>, <span class="fl">6</span><span class="op">)</span><span class="op">$</span><span class="va">imputations</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in model$impute("lm_pred", 1, 6): </span></span>
<span><span class="co">##  Data was sorted by the grouping variable - use `get_index()` to retrieve an order</span></span></code></pre>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model</span><span class="op">$</span><span class="fu">update_var</span><span class="op">(</span><span class="fl">2</span>, <span class="va">model</span><span class="op">$</span><span class="fu">impute_N</span><span class="op">(</span><span class="st">"lm_bayes"</span>, <span class="fl">2</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">5</span>,<span class="fl">6</span><span class="op">)</span>, <span class="fl">10</span><span class="op">)</span><span class="op">$</span><span class="va">imputations</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://amices.org/mice/reference/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">model</span><span class="op">$</span><span class="fu">get_data</span><span class="op">(</span><span class="op">)</span>, <span class="va">model</span><span class="op">$</span><span class="fu">get_g</span><span class="op">(</span><span class="op">)</span>, <span class="va">model</span><span class="op">$</span><span class="fu">get_w</span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">model</span><span class="op">$</span><span class="fu">get_index</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>, <span class="op">]</span>, <span class="fl">4</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8]      [,9]</span></span>
<span><span class="co">## [1,]   41  190  7.4   67    1    1    1    3 0.8644072</span></span>
<span><span class="co">## [2,]   36  118  8.0   72    2    1    2    7 0.5708125</span></span>
<span><span class="co">## [3,]   12  149 12.6   74    3    1    3    6 0.3919961</span></span>
<span><span class="co">## [4,]   18  313 11.5   62    4    1    4    8 1.0201001</span></span></code></pre>
<hr>
</div>
</div>
</div>
<div class="section level2">
<h2 id="tips-and-additional-notes">Tips and Additional Notes<a class="anchor" aria-label="anchor" href="#tips-and-additional-notes"></a>
</h2>
<ul>
<li>
<p><strong>Creating matrices from data frames</strong>: Remember
that standard R matrices can only hold one data type (often numeric).
Factor and character columns must be transformed (e.g., via
<code>model.matrix</code>).</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mtcars</span><span class="op">$</span><span class="va">cyl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">$</span><span class="va">cyl</span><span class="op">)</span></span>
<span><span class="va">mtcars</span><span class="op">$</span><span class="va">gear</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">$</span><span class="va">gear</span><span class="op">)</span></span>
<span><span class="va">mtcars_mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html" class="external-link">model.matrix</a></span><span class="op">(</span><span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">mtcars</span>, na.action <span class="op">=</span> <span class="st">"na.pass"</span><span class="op">)</span></span></code></pre></div>
</li>
<li>
<p><strong>Variance Inflation Factors (VIF)</strong>: VIF measures
how much the variance of a regression coefficient is inflated due to
collinearity. High values (&gt;10) may indicate problematic
collinearity.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">airquality2</span> <span class="op">&lt;-</span> <span class="va">airquality</span></span>
<span><span class="va">airquality2</span><span class="op">$</span><span class="va">Temp2</span> <span class="op">&lt;-</span> <span class="va">airquality2</span><span class="op">$</span><span class="va">Temp</span><span class="op">^</span><span class="fl">2</span></span>
<span><span class="va">airquality2</span><span class="op">$</span><span class="va">Month</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">airquality2</span><span class="op">$</span><span class="va">Month</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Using data.table:</span></span>
<span><span class="fu"><a href="../reference/VIF.html">VIF</a></span><span class="op">(</span></span>
<span>  <span class="va">airquality2</span>,</span>
<span>  posit_y <span class="op">=</span> <span class="st">"Ozone"</span>,</span>
<span>  posit_x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Solar.R"</span>, <span class="st">"Wind"</span>, <span class="st">"Temp"</span>, <span class="st">"Month"</span>, <span class="st">"Day"</span>, <span class="st">"Temp2"</span><span class="op">)</span>,</span>
<span>  correct <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
</li>
</ul>
<hr>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<ul>
<li><p><strong>Exposing C++ functions and classes with Rcpp
modules</strong><br>
Dirk Eddelbuettel and Romain FranÃ§ois (2018)<br><a href="https://dirk.eddelbuettel.com/code/rcpp/Rcpp-modules.pdf" class="external-link uri">https://dirk.eddelbuettel.com/code/rcpp/Rcpp-modules.pdf</a></p></li>
<li><p><strong>RcppArmadillo: Easily Extending R with High-Performance
C++ Code</strong><br>
Dirk Eddelbuettel and Conrad Sanderson (2012)<br><a href="https://dirk.eddelbuettel.com/papers/RcppArmadillo-intro.pdf" class="external-link uri">https://dirk.eddelbuettel.com/papers/RcppArmadillo-intro.pdf</a></p></li>
<li><p><strong>Extending R with C++: A Brief Introduction to
Rcpp</strong><br>
Dirk Eddelbuettel and James Joseph Balamuta (2018)<br><a href="https://dirk.eddelbuettel.com/code/rcpp/Rcpp-introduction.pdf" class="external-link uri">https://dirk.eddelbuettel.com/code/rcpp/Rcpp-introduction.pdf</a></p></li>
<li><p><strong>MICE: Multivariate Imputation by Chained Equations in
R</strong><br>
Stef van Buuren (2013)</p></li>
<li><p><strong>CSCE 666: Pattern Analysis</strong><br>
Ricardo Gutierrez-Osuna (Fall 2013)</p></li>
</ul>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Maciej Nasinski.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.9000.</p>
</div>

      </footer>
</div>






  </body>
</html>
